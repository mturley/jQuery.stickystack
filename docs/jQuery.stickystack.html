<!DOCTYPE html>  <html> <head>   <title>jQuery.stickystack.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               jQuery.stickystack.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <h2>a jQuery plugin for adaptive sticky element positioning written by <a href="http://www.miketurley.com">Mike Turley</a>.</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>jQuery.stickystack makes the active element in a selection stick to the edge of the screen.
it works by conditionally setting and unsetting fixed and absolute position on elements as you scroll.</p>

<p>a demo can be found <a href="../demo.html">here</a>.</p>

<p>the source code can be found <a href="https://github.com/mturley/jQuery.stickystack">on GitHub</a>.</p>

<p>this annotated source code was generated with the wonderful <a href="http://jashkenas.github.com/docco/">docco</a>.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h2>license</h2>

<p>jQuery.stickystack is dual-licensed under the
<a href="../MIT-LICENSE.txt">MIT</a> and
<a href="../GPL-LICENSE.txt">GPL</a> licenses, as is jQuery itself.
you may use jQuery.stickystack anywhere you are permitted to use jQuery, including in a commercial project
as long as this license statement is left intact.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <h2>usage</h2>

<pre><code>$(document).ready(function() {
  $(".some-class").stickystack();         // create
  // optionally, later on:
  $(".some-class").stickystackUnstick();  // destroy
});
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>the only global variable (not truly global, since it's in a closure) is <code>stacks</code>,
an array of objects to track the stacks you've created.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">$</span> <span class="p">)</span> <span class="p">{</span>

  <span class="kd">var</span> <span class="nx">stacks</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <h2>$.fn.* (jQuery selector functions)</h2>

<p>this plugin provides the following top-level jQuery functions:</p>

<ul>
<li><strong><code>$.fn.stickystack</code></strong> initializes a stickystack.</li>
<li><strong><code>$.fn.stickystackResetStyle</code></strong> restores element's original styles.</li>
<li><strong><code>$.fn.stickystackUpdate</code></strong> updates element positions on scroll.</li>
<li><strong><code>$.fn.stickystackUnstick</code></strong> undoes the effects of the plugin.</li>
<li><strong><code>$.fn.stickystackFindContainer</code></strong> looks for scrollbars.</li>
<li><strong><code>$.fn.stickystackCommonAncestor</code></strong> finds a common ancestor.</li>
<li><strong><code>$.fn.stickystackScrollable</code></strong> is a helper for the <code>scroll</code> event.</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <h2>$.fn.stickystack</h2>

<p>this is the main plugin function, used to set up a stickystack.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">stickystack</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mode</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">container</span><span class="p">,</span> <span class="nx">stack</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>this function treats the selection as a vertical stack of elements, and makes them sticky relative to the mode.
the "container" is defined as the nearest common ancestor which has a scrollbar. (see $.fn.stickystackFindContainer)</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>the mode can be 'top' or 'always', and defaults to 'top' if no mode is specified.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">mode</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="nx">mode</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">mode</span> <span class="o">!==</span> <span class="s1">&#39;top&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">mode</span> <span class="o">!==</span> <span class="s1">&#39;always&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">warn</span><span class="p">(</span><span class="s2">&quot;jQuery.stickystack: invalid mode: &quot;</span><span class="p">,</span><span class="nx">mode</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <ul>
<li>in 'top' mode, elements will:
<ul><li>be fixed at the top of the container when the user scrolls past them (one fixed element at a time).</li>
<li>be allowed to go out of view above the container only when the next element in the stack is scrolled to.</li>
<li>be allowed to go out of view below the container as normal.</li></ul></li>
<li>in 'always' mode, elements will:
<ul><li>be fixed at the top of the container if they normally would be out of view above the container.</li></ul></li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>this plugin only affects elements which would be out of view without the plugin.
elements whose static position is within the viewable area are left at that static position.
all positions and states are updated dynamically on the container's scroll event.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>if called on elements which are already "sticky", the plugin will refuse to repeat itself.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">&#39;stickystack-item&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">warn</span><span class="p">(</span><span class="s2">&quot;jQuery.stickystack: that stack is already sticky!&quot;</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">container</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stickystackFindContainer</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>each stack object keeps track of:</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <ul>
<li>what mode it was applied with</li>
<li>what elements it was applied to</li>
<li>what container to listen to</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">stack</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">&#39;mode&#39;</span>      <span class="o">:</span> <span class="nx">mode</span><span class="p">,</span>
      <span class="s1">&#39;elements&#39;</span>  <span class="o">:</span> <span class="k">this</span><span class="p">,</span>
      <span class="s1">&#39;container&#39;</span> <span class="o">:</span> <span class="nx">container</span>
    <span class="p">};</span>
    <span class="nx">stacks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">stack</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>this loop initializes each item in the stack.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;stickystack-item&#39;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;stickystack-mode-&#39;</span><span class="o">+</span><span class="nx">mode</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>a placeholder matching the width of each element is inserted before it, and given the element's full height
as a data key.  this way, we can apply and un-apply height to the placeholder, so that when elements are
positioned with float or absolute, the space they left behind in the document does not collapse.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">placeholder</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div /&gt;&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;stickystack-placeholder&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span>
        <span class="s1">&#39;width&#39;</span>  <span class="o">:</span> <span class="nx">t</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">(),</span>
        <span class="s1">&#39;height&#39;</span> <span class="o">:</span> <span class="s1">&#39;0&#39;</span>
      <span class="p">}).</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span>
      <span class="nx">placeholder</span><span class="p">.</span><span class="nx">data</span><span class="p">({</span>
        <span class="s1">&#39;fullHeight&#39;</span>     <span class="o">:</span> <span class="nx">t</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">(),</span>
        <span class="s1">&#39;placeholderFor&#39;</span> <span class="o">:</span> <span class="nx">t</span>
      <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>each element in the stack stores its original position so it can be reapplied later.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">t</span><span class="p">.</span><span class="nx">data</span><span class="p">({</span>
        <span class="s1">&#39;stickystackOriginalStyle&#39;</span> <span class="o">:</span> <span class="p">{</span>
          <span class="s1">&#39;position&#39;</span>   <span class="o">:</span> <span class="nx">t</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">),</span>
          <span class="s1">&#39;top&#39;</span>        <span class="o">:</span> <span class="nx">t</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;top&#39;</span><span class="p">),</span>
          <span class="s1">&#39;left&#39;</span>       <span class="o">:</span> <span class="nx">t</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">),</span>
          <span class="s1">&#39;width&#39;</span>      <span class="o">:</span> <span class="nx">t</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">),</span>
          <span class="s1">&#39;z-index&#39;</span>    <span class="o">:</span> <span class="nx">t</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;z-index&#39;</span><span class="p">),</span>
          <span class="s1">&#39;visibility&#39;</span> <span class="o">:</span> <span class="nx">t</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;visibility&#39;</span><span class="p">)</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>each element in the stack also stores references to the stack's container...</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="s1">&#39;stickystackContainer&#39;</span>   <span class="o">:</span> <span class="nx">container</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>...previous and next items...</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="s1">&#39;stickystackPrevItem&#39;</span>    <span class="o">:</span> <span class="p">(</span><span class="nx">index</span> <span class="o">!==</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">$</span><span class="p">(</span><span class="nx">stack</span><span class="p">.</span><span class="nx">elements</span><span class="p">[</span><span class="nx">index</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">:</span> <span class="nx">$</span><span class="p">([])),</span>
        <span class="s1">&#39;stickystackNextItem&#39;</span>    <span class="o">:</span> <span class="p">(</span><span class="nx">index</span> <span class="o">!==</span> <span class="nx">stack</span><span class="p">.</span><span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="nx">$</span><span class="p">(</span><span class="nx">stack</span><span class="p">.</span><span class="nx">elements</span><span class="p">[</span><span class="nx">index</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">:</span> <span class="nx">$</span><span class="p">([])),</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>...the placeholder and the mode.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="s1">&#39;stickystackPlaceholder&#39;</span> <span class="o">:</span> <span class="nx">placeholder</span><span class="p">,</span>
        <span class="s1">&#39;stickystackMode&#39;</span>        <span class="o">:</span> <span class="nx">mode</span>
      <span class="p">});</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>if the container is not already initialized, set up the scroll listener
using <a href="http://api.jquery.com/on/">jQuery.on()</a> with a .stickystack namespace.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">container</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackInitialized&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">container</span><span class="p">.</span><span class="nx">stickystackScrollable</span><span class="p">().</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;scroll.stickystack&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">container</span><span class="p">.</span><span class="nx">stickystackUpdate</span><span class="p">();</span>
      <span class="p">});</span>
      <span class="nx">container</span><span class="p">.</span><span class="nx">data</span><span class="p">({</span>
        <span class="s1">&#39;stickystackInitialized&#39;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s1">&#39;stickystackObj&#39;</span>         <span class="o">:</span> <span class="nx">stack</span>   <span class="c1">// each container stores a reference to its stack object for easy access.</span>
      <span class="p">});</span>
      <span class="nx">container</span><span class="p">.</span><span class="nx">stickystackUpdate</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <h2>$.fn.stickystackResetStyle</h2>

<p>restores element's original styles and flattens the placeholder element back to height 0.
this is called on elements that should no longer be fixed or absolute.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">stickystackResetStyle</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">orig</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackOriginalStyle&#39;</span><span class="p">);</span>
      <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">orig</span><span class="p">)</span> <span class="p">{</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="nx">prop</span><span class="p">,</span> <span class="nx">orig</span><span class="p">[</span><span class="nx">prop</span><span class="p">]);</span> <span class="p">}</span>
      <span class="kd">var</span> <span class="nx">placeholder</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackPlaceholder&#39;</span><span class="p">);</span>
      <span class="nx">placeholder</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">);</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;stickystack-fixed stickystack-absolute&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <h2>$.fn.stickystackUpdate</h2>

<p>called on scroll, this function updates the positions of items in the stack.
it is to be called with the selection as an initialized container.
this is where most of the magic happens!</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">stickystackUpdate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">container</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">))</span> <span class="nx">container</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">container</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackInitialized&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">warn</span><span class="p">(</span><span class="s2">&quot;jQuery.stickystack: that&#39;s not an initialized stickystack container:&quot;</span><span class="p">,</span> <span class="nx">container</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">first</span><span class="p">().</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackContainer&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">log</span><span class="p">(</span><span class="s2">&quot;jQuery.stickystack: updated anyway based on the associated container.&quot;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">first</span><span class="p">().</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackContainer&#39;</span><span class="p">).</span><span class="nx">stickystackUpdate</span><span class="p">();</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">topBuffer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>first we calculate the offset left-position of the first element placeholder in the stack, which we'll use later.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">leftPos</span> <span class="o">=</span> <span class="nx">container</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackObj&#39;</span><span class="p">).</span><span class="nx">elements</span><span class="p">.</span><span class="nx">first</span><span class="p">().</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackPlaceholder&#39;</span><span class="p">).</span><span class="nx">offset</span><span class="p">().</span><span class="nx">left</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>the function loops through each of the elements in the stack:</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">container</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.stickystack-item&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>for each element, fetch the mode, placeholder, width, scrollTop and previous element.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">mode</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackMode&#39;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">placeholder</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackPlaceholder&#39;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">width</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">width</span><span class="p">();</span>
      <span class="kd">var</span> <span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackContainer&#39;</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">();</span>
      <span class="kd">var</span> <span class="nx">prev</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackPrevItem&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>detect whether this element's placeholder is out of view above the window.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">outOfViewAbove</span> <span class="o">=</span> <span class="nx">placeholder</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">&lt;=</span> <span class="nx">scrollTop</span> <span class="o">+</span> <span class="nx">topBuffer</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>detect whether this element is currently colliding with the previous element.
this will only occur when the previous element is fixed, and this element has been scrolled into it.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">colliding</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">prev</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">colliding</span> <span class="o">=</span> <span class="nx">placeholder</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">&lt;=</span> <span class="nx">prev</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">prev</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>if a collision is detected, set the previous element's position absolutely to just above this element.
this is what gives the effect of sticky elements "bumping" each other out of the way.
in a collision, we also assert that the previous element's placeholder is taking up its full height.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span><span class="nx">colliding</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">prev</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;stickystack-fixed&#39;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;stickystack-absolute&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span>
          <span class="s1">&#39;position&#39;</span>   <span class="o">:</span> <span class="s1">&#39;absolute&#39;</span><span class="p">,</span>
          <span class="s1">&#39;top&#39;</span>        <span class="o">:</span> <span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span> <span class="o">-</span> <span class="nx">prev</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">())</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">,</span>
          <span class="s1">&#39;left&#39;</span>       <span class="o">:</span> <span class="nx">leftPos</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">,</span>
          <span class="s1">&#39;width&#39;</span>      <span class="o">:</span> <span class="nx">width</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">,</span>
          <span class="s1">&#39;z-index&#39;</span>    <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="s1">&#39;visibility&#39;</span> <span class="o">:</span> <span class="s1">&#39;visible&#39;</span>
        <span class="p">});</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">prev</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">left</span> <span class="o">!=</span> <span class="nx">leftPos</span><span class="p">)</span> <span class="nx">prev</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="s1">&#39;0px&#39;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">prevplaceholder</span> <span class="o">=</span> <span class="nx">prev</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackPlaceholder&#39;</span><span class="p">);</span>
        <span class="nx">prevplaceholder</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nx">prevplaceholder</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;fullHeight&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">);</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>if this element's placeholder is in view, ensure we are not messing with its styles.
otherwise, set it as the fixed element.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">outOfViewAbove</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">t</span><span class="p">.</span><span class="nx">stickystackResetStyle</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">t</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;stickystack-absolute&#39;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;stickystack-fixed&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span>
          <span class="s1">&#39;position&#39;</span>   <span class="o">:</span> <span class="s1">&#39;fixed&#39;</span><span class="p">,</span>
          <span class="s1">&#39;top&#39;</span>        <span class="o">:</span> <span class="nx">topBuffer</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">,</span>
          <span class="s1">&#39;left&#39;</span>       <span class="o">:</span> <span class="nx">leftPos</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">,</span>
          <span class="s1">&#39;width&#39;</span>      <span class="o">:</span> <span class="nx">width</span><span class="o">+</span><span class="s1">&#39;px&#39;</span><span class="p">,</span>
          <span class="s1">&#39;z-index&#39;</span>    <span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
          <span class="s1">&#39;visibility&#39;</span> <span class="o">:</span> <span class="s1">&#39;visible&#39;</span>
        <span class="p">});</span>
        <span class="nx">placeholder</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span>
          <span class="s1">&#39;height&#39;</span> <span class="o">:</span> <span class="nx">placeholder</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;fullHeight&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;px&#39;</span>
        <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>if this element's sticky mode is 'always', we add its height to the topBuffer.
this forces other sticky elements to be fixed just below it since it will always be in view.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="nx">mode</span> <span class="o">===</span> <span class="s1">&#39;always&#39;</span><span class="p">)</span> <span class="nx">topBuffer</span> <span class="o">+=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">outerHeight</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>if there is a 'top'-mode element which is currently fixed, hide all absolutely-positioned items.
this means that once an item is moved above its fixed position, it disappears rather than hanging out
behind whatever other elements may be there.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">container</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.stickystack-fixed.stickystack-mode-top&#39;</span><span class="p">).</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">container</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.stickystack-absolute&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;visibility&#39;</span><span class="p">,</span><span class="s1">&#39;hidden&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <h2>$.fn.stickystackUnstick</h2>

<p>this function reverses all effects of the plugin for the selected elements.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">stickystackUnstick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">classes</span> <span class="o">=</span> <span class="s1">&#39;stickystack-item stickystack-mode-top stickystack-mode-always stickystack-fixed stickystack-absolute&#39;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">container</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">first</span><span class="p">().</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackContainer&#39;</span><span class="p">);</span>
    <span class="nx">container</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;stickystack-placeholder&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
    <span class="nx">container</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;stickystack-item&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">classes</span><span class="p">);</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">stickystackResetStyle</span><span class="p">();</span>
      <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">removeData</span><span class="p">([</span><span class="s1">&#39;stickystackOriginalStyle&#39;</span><span class="p">,</span> <span class="s1">&#39;stickystackContainer&#39;</span><span class="p">]);</span>
    <span class="p">});</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">container</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackInitialized&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">container</span><span class="p">.</span><span class="nx">stickystackScrollable</span><span class="p">().</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;scroll.stickystack&#39;</span><span class="p">);</span>
      <span class="nx">container</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;stickystackObj&#39;</span><span class="p">).</span><span class="nx">detached</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="nx">stacks</span> <span class="o">=</span> <span class="nx">stacks</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">stack</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">!</span><span class="nx">stack</span><span class="p">.</span><span class="nx">detached</span><span class="p">;</span> <span class="p">});</span>
      <span class="nx">container</span><span class="p">.</span><span class="nx">removeData</span><span class="p">([</span><span class="s1">&#39;stickystackObj&#39;</span><span class="p">,</span> <span class="s1">&#39;stickystackInitialized&#39;</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <h2>$.fn.stickystackFindContainer</h2>

<p>this function searches the element's ancestors for the nearest element with a scrollbar.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">stickystackFindContainer</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">stickystackCommonAncestor</span><span class="p">();</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nx">t</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">))</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;overflow&#39;</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">o</span> <span class="o">===</span> <span class="s1">&#39;auto&#39;</span> <span class="o">||</span> <span class="nx">o</span> <span class="o">===</span> <span class="s1">&#39;scroll&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">t</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">scrollHeight</span> <span class="o">&gt;</span> <span class="nx">t</span><span class="p">.</span><span class="nx">height</span><span class="p">())</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">t</span><span class="p">;</span> <span class="p">}</span>
      <span class="nx">t</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">parent</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <h2>$.fn.stickystackCommonAncestor</h2>

<p>this function finds the closest element which is a parent of all selected elements.
<strong>disclaimer: this function is borrowed without explicit permission from <a href="http://stackoverflow.com/a/3217279">http://stackoverflow.com/a/3217279</a></strong></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">stickystackCommonAncestor</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">parents</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">var</span> <span class="nx">minlen</span> <span class="o">=</span> <span class="kc">Infinity</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">curparents</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">parents</span><span class="p">();</span>
      <span class="nx">parents</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">curparents</span><span class="p">);</span>
      <span class="nx">minlen</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">minlen</span><span class="p">,</span> <span class="nx">curparents</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">parents</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">parents</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">parents</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">slice</span><span class="p">(</span><span class="nx">parents</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">minlen</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">parents</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">equal</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="k">in</span> <span class="nx">parents</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">parents</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">i</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">parents</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span>
          <span class="nx">equal</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">equal</span><span class="p">)</span> <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nx">parents</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">$</span><span class="p">([]);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <h2>$.fn.stickystackScrollable</h2>

<p>this 2-line function simply makes sure the selected element is one that can trigger a 'scroll' event.
it only exists to handle the special case in which the container is the body tag, in which case
the 'scroll' event is really coming from the window.
In other cases, the scrollable and the container are the same element.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">stickystackScrollable</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">is</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">))</span> <span class="k">return</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <h2>$(document).ready event</h2>

<p>when the document is ready, we bind to the window's resize event.  on that event, we loop through all our
stacks and update item positions in each.  this fixes a bug where positions get messed up on window resize.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">resize</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">stacks</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">idx</span><span class="p">,</span> <span class="nx">stack</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">stack</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">stickystackUpdate</span><span class="p">();</span>
      <span class="p">});</span>
    <span class="p">})</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>nerf the console functions so they work if present, but don't break things if absent.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">function</span> <span class="nx">log</span><span class="p">()</span> <span class="p">{</span> <span class="k">if</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">)</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">console</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span> <span class="p">}</span>
  <span class="kd">function</span> <span class="nx">warn</span><span class="p">()</span> <span class="p">{</span> <span class="k">if</span><span class="p">(</span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">)</span> <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">console</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span> <span class="p">}</span>

<span class="p">})(</span> <span class="nx">jQuery</span> <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>that's it!  you read all the way to the bottom!  aren't you having an exciting day.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 